      SUBROUTINE IAD2D(MACH,DELTA,L,H,W,MFR,SREF,CXADD,MFRM) 
C 
C  THIS ROUTINE CALCULATES THE ADDITIVE DRAG FOR 2-D
C  INLETS OPERATING AT OFF DESIGN CONDITIONS
C
C  WRITTEN BY W. BLAKE, WL/FIGC
C 
C  METHOD TAKEN FROM NEAR TR 396, VOL II
C 
C  INPUTS:  
C      MACH  - FREE-STREAM MACH NUMBER
C      DELTA - INLET RAMP ANGLE 
C      L     - LENGTH FROM RAMP APEX TO INLET LIP 
C      H     - INLET HEIGHT 
C      W     - INLET WIDTH
C      MFR   - INLET MASS FLOW RATIO
C      SREF  - REFERENCE AREA 
C 
C  OUTPUT:  
C      CXADD - ADDITIVE DRAG AT REFERENCE CONDITION 
C 
C  INTERMEDIATE RESULTS:  
C      CXSTG - ADDITIVE DRAG AT FULLY BLOCKED CONDITIONS (MFR=0)
C      MFRM  - MAXIMUM MASS FLOW RATIO POSSIBLE AT SPECIFIED CONDITION
C      CXBLK - ADDITIVE DRAG AT MFR = MFRM
C 
      COMMON /CONST/ PI,RAD,UNUSED,KAND
      DIMENSION TGR(7), TCU(4), TX(5)
      DIMENSION CXS(140), MFM(140), CXB1(140), CXB2(140)
      REAL L,LH,MACH,MFR,MFRM,MFM 
C 
      DATA TGR / 1.0, 1.25, 1.5, 2.0, 3.0, 4.0, 5.0 / 
      DATA TCU / 1.5, 2.5, 3.5, 4.5 / 
      DATA TX  / 0., 3., 6., 9., 12. /
C 
C  THE DATA ARE STACKED AS FOLLOWS: 
C 
C  MACH = 1.0 ARE LINES A & B,   MACH =1.25 ARE LINES C & D 
C  MACH = 1.5 ARE LINES E & F,   MACH = 2.0 ARE LINES G & H 
C  MACH = 3.0 ARE LINES I & J,   MACH = 4.0 ARE LINES K & L 
C  MACH = 5.0 ARE LINES M & N 
C 
C  FOR EACH MACH NUMBER, THERE ARE 4 CURVES CORRESPONDING TO THE
C  4 INLET LENGTHS.  THE INLET LENGTHS ARE 1.5,2.5,3.5 AND 4.5
C  FOR EACH LENGTH, THERE ARE 5 POINTS CORRESPONDING TO THE RAMP
C  ANGLE.  THE RAMP ANGLES ARE 0,3,6,9, AND 12 DEG
C 
C  CXBLK TABLES (WIDTH/HEIGHT = 2.0)
      DATA CXB2 / 
     A  0.000,0.158,0.296,0.407,0.508,0.000,0.220,0.341,0.389,0.422,
     B  0.000,0.225,0.251,0.229,0.244,0.000,0.180,0.148,0.143,0.190,
     C  0.000,0.080,0.232,0.331,0.421,0.000,0.127,0.282,0.339,0.370,
     D  0.000,0.139,0.233,0.226,0.222,0.000,0.130,0.154,0.132,0.199,
     E  0.000,0.034,0.098,0.198,0.366,0.001,0.078,0.169,0.262,0.349,
     F  0.001,0.093,0.164,0.201,0.221,0.002,0.093,0.128,0.131,0.207,
     G  0.000,0.000,0.009,0.044,0.110,0.000,0.034,0.090,0.165,0.255,
     H  0.001,0.054,0.117,0.176,0.243,0.001,0.061,0.107,0.146,0.250,
     I  0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.014,0.054,0.128,
     J  0.000,0.018,0.058,0.119,0.204,0.000,0.030,0.076,0.133,0.236,
     K  0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.044,
     L  0.000,0.002,0.022,0.072,0.160,0.000,0.013,0.049,0.110,0.216,
     M  0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.000,
     N  0.0  ,0.0  ,0.000,0.037,0.123,0.000,0.003,0.028,0.087,0.197/
C
C   CXBLK TABLES (WIDTH/HEIGHT = 1.0) 
      DATA CXB1 / 
     A  0.000,0.074,0.126,0.162,0.184,0.000,0.089,0.109,0.100,0.091,
     B  0.000,0.071,0.057,0.045,0.047,0.000,0.044,0.029,0.026,0.037,
     C  0.000,0.039,0.105,0.137,0.162,0.000,0.057,0.100,0.099,0.093,
     D  0.000,0.055,0.059,0.045,0.044,0.000,0.042,0.029,0.024,0.040,
     E  0.000,0.017,0.047,0.090,0.147,0.001,0.036,0.070,0.088,0.093,
     F  0.001,0.040,0.054,0.049,0.044,0.001,0.035,0.033,0.025,0.042,
     G  0.000,0.000,0.004,0.022,0.053,0.000,0.016,0.040,0.066,0.087,
     H  0.000,0.024,0.043,0.051,0.056,0.001,0.025,0.032,0.031,0.054,
     I  0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.007,0.026,0.056,
     J  0.000,0.009,0.025,0.045,0.064,0.000,0.013,0.027,0.037,0.068,
     K  0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.022,
     L  0.0  ,0.001,0.011,0.032,0.061,0.0  ,0.006,0.020,0.037,0.073,
     M  0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,0.0  ,
     N  0.0  ,0.0  ,0.0  ,0.018,0.052,0.0  ,0.002,0.013,0.034,0.072/
C 
C  MFRM TABLES
      DATA MFM /
     A  1.0 , .930, .858, .784, .708, 1.0 , .877, .751, .621, .487, 
     B  1.0 , .824, .644, .458, .266, 1.0 , .771, .537, .296, .045, 
     C  1.0 , .951, .875, .808, .737, 1.0 , .897, .766, .640, .507, 
     D  1.0 , .843, .657, .472, .277, 1.0 , .789, .547, .304, .047, 
     E  1.0 , .972, .926, .860, .759, 1.0 , .917, .810, .681, .522, 
     F  1.0 , .861, .695, .502, .285, 1.0 , .806, .579, .324, .048, 
     G  1.0 , 1.0 , .990, .954, .896, 1.0 , .947, .866, .756, .616, 
     H  1.0 , .890, .743, .558, .337, 1.0 , .833, .619, .360, .057, 
     I  1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , .966, .886, .755, 
     J  1.0 , .941, .828, .653, .413, 1.0 , .881, .691, .421, .070, 
     K  1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , .893, 
     L  1.00,0.992,0.914,0.749,0.488,1.000,0.928,0.762,0.483,0.083, 
     M  1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.0 , 1.00, 
     N  1.0 , 1.0 , 1.00,0.848,0.564, 1.0 ,0.976,0.836,0.547,0.096/ 
C 
C  CXSTAG TABLES
      DATA CXS /
     A  1.275,1.171,1.067,0.961,0.853,1.275,1.102,0.927,0.751,0.571,
     B  1.275,1.032,0.788,0.541,0.289,1.275,0.963,0.649,0.331,0.007,
     C  1.420,1.324,1.264,1.184,1.102,1.420,1.258,1.158,1.024,0.887,
     D  1.419,1.192,1.052,0.864,0.673,1.422,1.126,0.946,0.704,0.458,
     E  1.530,1.420,1.325,1.254,1.239,1.530,1.344,1.187,1.069,1.044,
     F  1.530,1.270,1.049,0.884,0.849,1.530,1.195,0.911,0.699,0.654,
     G  1.654,1.654,1.418,1.316,1.230,1.654,1.449,1.258,1.089,0.945,
     H  1.652,1.365,1.098,0.862,0.660,1.651,1.282,0.939,0.634,0.376,
     I  1.750,1.750,1.750,1.750,1.750,1.750,1.750,1.318,1.118,0.936,
     J  1.750,1.441,1.143,0.864,0.608,1.750,1.351,0.967,0.609,0.280,
     K  1.790,1.790,1.790,1.790,1.790,1.790,1.790,1.790,1.790,0.932,
     L  1.790,1.469,1.158,0.863,0.588,1.790,1.376,0.977,0.598,0.244,
     M  1.776,1.776,1.776,1.776,1.776,1.776,1.776,1.776,1.776,1.776,
     N  1.776,1.776,1.776,0.862,0.577,1.776,1.388,0.981,0.591,0.225/
C 
      LH=L/H
C 
C  CALCULATE CXSTG
      CALL MVLOOK(7,4,5,140,TGR,TCU,TX,CXS,DELTA,LH,MACH,CXSTG) 
C 
C  CALCULATE MFRM 
      CALL MVLOOK(7,4,5,140,TGR,TCU,TX,MFM,DELTA,LH,MACH,MFRM)
C 
C  CALCULATE CXBLK FOR WIDTH/HEIGHT = 1.0 
      CALL MVLOOK(7,4,5,140,TGR,TCU,TX,CXB1,DELTA,LH,MACH,CXBLK1) 
C 
C  CALCULATE CXBLK FOR WIDTH/HEIGHT = 2.0 
      CALL MVLOOK(7,4,5,140,TGR,TCU,TX,CXB2,DELTA,LH,MACH,CXBLK2) 
C 
C  SCALE CXBLK AND CXSTAG TO USER HEIGHT/WIDTH RATIO
      CXBLK=CXBLK2+(2.-W/H)*(CXBLK1-CXBLK2) 
      CXSTG=CXSTG*W/H 
C 
C  CALCULATE CXADD
      CXADD=(1.-MFR/MFRM)*(CXSTG-CXBLK)+CXBLK 
      IF(CXADD.LT.0.) CXADD=0.
C
C  CORRECT TO USER REFERENCE AREA
      SCOR=H*W/SREF 
      CXADD=CXADD*SCOR
      RETURN
      END 
