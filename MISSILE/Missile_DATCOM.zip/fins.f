      SUBROUTINE FINS(IM,NFIN)
C
C***  TOP LEVEL EXECUTIVE FOR FIN ALONE AERODYNAMICS
C
C***  IM IS THE CURRENT MACH NUMBER INDEX
C***  NFIN IS THE CURRENT FIN SET INDEX
C
      COMMON /CONST/ PI,RAD,UNUSED,KAND
C
      COMMON /REFQN/  SREF,LREF,LATREF,ROUGH,XCG,ZCG,SCALE,BLAYER,RHR
      REAL LREF,LATREF
C
      COMMON /FLC/    NALPHA,ALPHA(20),BETA,PHI,NMACH,MACH(20),
     1                ALT(20),REN(20),VINF(20),TINF(20),PINF(20)
      REAL NALPHA,NMACH,MACH
C
      COMMON /TOTALC/ BALPHA(20),BBETA(20),BPHI(20),ALPTOT(20)
C
      COMMON /GEOFS1/ GFIN1(188)
      COMMON /GEOFS2/ GFIN2(188)
      COMMON /GEOFS3/ GFIN3(188)
      COMMON /GEOFS4/ GFIN4(188)
C
      COMMON /FSET1/  FDATA1(399)
      COMMON /FSET2/  FDATA2(399)
      COMMON /FSET3/  FDATA3(399)
      COMMON /FSET4/  FDATA4(399)
C
      COMMON /GEOFC/  GFINC(21)
C
      COMMON /SFIN1/ CNF1(20),CMF1(20),CAF1(20),CYF1(20),CLNF1(20),
     1               CLLF1(20),CNAF1(20),CMAF1(20),CYBF1(20),
     2               CNBF1(20),CLBF1(20)
      COMMON /SFIN2/ CNF2(20),CMF2(20),CAF2(20),CYF2(20),CLNF2(20),
     1               CLLF2(20),CNAF2(20),CMAF2(20),CYBF2(20),
     2               CNBF2(20),CLBF2(20)
      COMMON /SFIN3/ CNF3(20),CMF3(20),CAF3(20),CYF3(20),CLNF3(20),
     1               CLLF3(20),CNAF3(20),CMAF3(20),CYBF3(20),
     2               CNBF3(20),CLBF3(20)
      COMMON /SFIN4/ CNF4(20),CMF4(20),CAF4(20),CYF4(20),CLNF4(20),
     1               CLLF4(20),CNAF4(20),CMAF4(20),CYBF4(20),
     2               CNBF4(20),CLBF4(20)
C
      COMMON /F1WORK/ RHO1,TMAX1,KSHAR1,CCLA1(20),XAC1(20),CMCO41(20),
     1                CNALF1,CNAAF1(20),CNLF1(20),CNNLF1(20),CNF1AT(20),
     2                XCPL1,XCPNL1,CMFL1(20),CMFNL1(20),CMF1AT(20),
     3                CAOF1,CANLF1(20),ALPTF1(20),CNFIT1(20),AI1,ALO1,
     4                CLI1,CLM1(20)
      COMMON /F2WORK/ RHO2,TMAX2,KSHAR2,CCLA2(20),XAC2(20),CMCO42(20),
     1                CNALF2,CNAAF2(20),CNLF2(20),CNNLF2(20),CNF2AT(20),
     2                XCPL2,XCPNL2,CMFL2(20),CMFNL2(20),CMF2AT(20),
     3                CAOF2,CANLF2(20),ALPTF2(20),CNFIT2(20),AI2,ALO2,
     4                CLI2,CLM2(20)
      COMMON /F3WORK/ RHO3,TMAX3,KSHAR3,CCLA3(20),XAC3(20),CMCO43(20),
     1                CNALF3,CNAAF3(20),CNLF3(20),CNNLF3(20),CNF3AT(20),
     2                XCPL3,XCPNL3,CMFL3(20),CMFNL3(20),CMF3AT(20),
     3                CAOF3,CANLF3(20),ALPTF3(20),CNFIT3(20),AI3,ALO3,
     4                CLI3,CLM3(20)
      COMMON /F4WORK/ RHO4,TMAX4,KSHAR4,CCLA4(20),XAC4(20),CMCO44(20),
     1                CNALF4,CNAAF4(20),CNLF4(20),CNNLF4(20),CNF4AT(20),
     2                XCPL4,XCPNL4,CMFL4(20),CMFNL4(20),CMF4AT(20),
     3                CAOF4,CANLF4(20),ALPTF4(20),CNFIT4(20),AI4,ALO4,
     4                CLI4,CLM4(20)
C
      COMMON /PARTF/ PARTS(19)
      LOGICAL PARTS
      COMMON /LOGIC/ LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,
     1               LDERRD,LPART,LNAME,LPLOT,
     2               LFLT,LREFQ,LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,
     3               LDEFL,LTRIM,LDIMIN,LDIMFT,LDIMCM,LDIMM,LELLB,
     4               LINLET,LEXPR,LICRMT,LSPIN,LARBOD
      LOGICAL        LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,
     1               LDERRD,LPART,LNAME,LPLOT,
     2               LFLT,LREFQ,LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,
     3               LDEFL,LTRIM,LDIMIN,LDIMFT,LDIMCM,LDIMM,LELLB,
     4               LINLET,LEXPR,LICRMT,LSPIN,LARBOD
C
      DIMENSION IROUT(2),RTRANS(7)
C
C***  ACCESS FIN GEOMETRY AND DEFINE CURRENT FIN GEOMETRY
C***  FOR TRANSFER IN LABELED COMMON GEOFC.  FIN CHARACTERISTICS
C***  ARE FOR SINGLE PANEL.  TEMPORARY FIX FOR DELTAD OF
C***  FINS 1 AND 2 (USE GEOMETRY COMPUTED VALUE IN THE FUTURE
C***  AND DELETE THESE LINES)
C
      DO 1040 I=1,16
       J=170+I
       GO TO (1000,1010,1020,1030),NFIN
C
 1000   GFINC(I)=GFIN1(J)
        IF(I .NE. 16) GO TO 1040
        GFINC(17) = FDATA1(363)
        GFINC(18) = FDATA1(112)
        GFINC(19) = FDATA1(102)
        GFINC(20) = GFIN1(187)
        GFINC(21) = FDATA1(52)
        GO TO 1040
 1010   GFINC(I)=GFIN2(J)
        IF(I .NE. 16) GO TO 1040
        GFINC(17) = FDATA2(363)
        GFINC(18) = FDATA2(112)
        GFINC(19) = FDATA2(102)
        GFINC(20) = GFIN2(187)
        GFINC(21) = FDATA2(52)
        GO TO 1040
 1020   GFINC(I)=GFIN3(J)
        IF(I .NE. 16) GO TO 1040
        GFINC(17) = FDATA3(363)
        GFINC(18) = FDATA3(112)
        GFINC(19) = FDATA3(102)
        GFINC(20) = GFIN3(187)
        GFINC(21) = FDATA3(52)
        GO TO 1040
 1030   GFINC(I)=GFIN4(J)
        IF(I .NE. 16) GO TO 1040
        GFINC(17) = FDATA4(363)
        GFINC(18) = FDATA4(112)
        GFINC(19) = FDATA4(102)
        GFINC(20) = GFIN4(187)
        GFINC(21) = FDATA4(52)
C
 1040 CONTINUE
        GFINC(16)=RAD*ATAN(GFINC(15)/5.85)
C
C***  COMPUTE NORMAL FORCE
C
      CALL FINCN(IM,NFIN)
C
C***  COMPUTE AXIAL FORCE
C
      CALL FINCA(IM,NFIN)
C
C***  COMPUTE PITCHING MOMENT
C
      CALL FINCM(IM,NFIN)
C
C***  DIFFERENTIATE CN AND CM CURVES
C
      NALP=NALPHA+0.5
      DO 1090 I=1,NALP
       GO TO (1050,1060,1070,1080),NFIN
 1050    CALL POLINT(ALPHA,CNF1,NALP,ALPHA(I),CNFINT,CNAF1(I))
         CALL POLINT(ALPHA,CMF1,NALP,ALPHA(I),CMFINT,CMAF1(I))
         GO TO 1090
 1060    CALL POLINT(ALPHA,CNF2,NALP,ALPHA(I),CNFINT,CNAF2(I))
         CALL POLINT(ALPHA,CMF2,NALP,ALPHA(I),CMFINT,CMAF2(I))
         GO TO 1090
 1070    CALL POLINT(ALPHA,CNF3,NALP,ALPHA(I),CNFINT,CNAF3(I))
         CALL POLINT(ALPHA,CMF3,NALP,ALPHA(I),CMFINT,CMAF3(I))
         GO TO 1090
 1080    CALL POLINT(ALPHA,CNF4,NALP,ALPHA(I),CNFINT,CNAF4(I))
         CALL POLINT(ALPHA,CMF4,NALP,ALPHA(I),CMFINT,CMAF4(I))
C
 1090 CONTINUE
C
C***  DIRECTIONAL DERIVATIVES (BLANK OUT FIELDS)
C
      DO 1100 I=1,20
         CYF1(I)=-UNUSED
         CLNF1(I)=-UNUSED
         CLLF1(I)=-UNUSED
         CYBF1(I)=-UNUSED
         CNBF1(I)=-UNUSED
         CLBF1(I)=-UNUSED
         CYF2(I)=-UNUSED
         CLNF2(I)=-UNUSED
         CLLF2(I)=-UNUSED
         CYBF2(I)=-UNUSED
         CNBF2(I)=-UNUSED
         CLBF2(I)=-UNUSED
         CYF3(I)=-UNUSED
         CLNF3(I)=-UNUSED
         CLLF3(I)=-UNUSED
         CYBF3(I)=-UNUSED
         CNBF3(I)=-UNUSED
         CLBF3(I)=-UNUSED
         CYF4(I)=-UNUSED
         CLNF4(I)=-UNUSED
         CLLF4(I)=-UNUSED
         CYBF4(I)=-UNUSED
         CNBF4(I)=-UNUSED
         CLBF4(I)=-UNUSED
 1100 CONTINUE
C
      RETURN
      END
