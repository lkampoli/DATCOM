      SUBROUTINE FINCM (IM,NFIN)
C      
C***  EXECUTIVE SUBROUTINE TO COMPUTE FIN ALONE PITCHING MOMENT
C      
C***  REFERENCE      NACA TR 1307
C      
C***  INPUT          IM       MACH NUMBER INDEX
C***                 NFIN     FIN SET INDEX
C***  OUTPUT         CMFX     FIN ALONE PITCHING MOMENT WITH RESPECT
C***                          TO XCG AND REFERENCED TO SREF,LREF
C***                             (LABELED COMMON SFINX)
C      
      COMMON /CONST/ PI,RAD,UNUSED,KAND
C      
      COMMON /REFQN/  SREF,LREF,LATREF,ROUGH,XCG,ZCG,SCALE,BLAYER,RHR
      REAL LREF,LATREF
C      
      COMMON /FLC/    NALPHA,ALPHA(20),BETA,PHI,NMACH,MACH(20),
     1                ALT(20),REN(20),VINF(20),TINF(20),PINF(20)
      REAL NALPHA,NMACH,MACH
C      
      COMMON /TOTALC/ BALPHA(20),BBETA(20),BPHI(20),ALPTOT(20)
C      
      COMMON /ABODIN/ BDIN(881)
C      
      COMMON /GEOFC/ FINAR,FINTPR,FINSPN,FINSP,FINWET,TCEFF,
     1               FINXGC,FINYGC,SWAVLE,SWAV25,SWAV50,SWAV75,
     2               SWAVTE,FINCBR,DELTAY,DELTAD,FINPHI,NPANEL,
     3               XLEF,XCENF,CROOT
      REAL NPANEL
C      
      COMMON /F1WORK/ RHO1,TMAX1,KSHAR1,CCLA1(20),XAC1(20),CMCO41(20),
     1                CNALF1,CNAAF1(20),CNLF1(20),CNNLF1(20),CNF1AT(20),
     2                XCPL1,XCPNL1,CMFL1(20),CMFNL1(20),CMF1AT(20),
     3                CAOF1,CANLF1(20),ALPTF1(20),CNFIT1(20),AI1,ALO1,
     4                CLI1,CLM1(20)
      COMMON /F2WORK/ RHO2,TMAX2,KSHAR2,CCLA2(20),XAC2(20),CMCO42(20),
     1                CNALF2,CNAAF2(20),CNLF2(20),CNNLF2(20),CNF2AT(20),
     2                XCPL2,XCPNL2,CMFL2(20),CMFNL2(20),CMF2AT(20),
     3                CAOF2,CANLF2(20),ALPTF2(20),CNFIT2(20),AI2,ALO2,
     4                CLI2,CLM2(20)
      COMMON /F3WORK/ RHO3,TMAX3,KSHAR3,CCLA3(20),XAC3(20),CMCO43(20),
     1                CNALF3,CNAAF3(20),CNLF3(20),CNNLF3(20),CNF3AT(20),
     2                XCPL3,XCPNL3,CMFL3(20),CMFNL3(20),CMF3AT(20),
     3                CAOF3,CANLF3(20),ALPTF3(20),CNFIT3(20),AI3,ALO3,
     4                CLI3,CLM3(20)
      COMMON /F4WORK/ RHO4,TMAX4,KSHAR4,CCLA4(20),XAC4(20),CMCO44(20),
     1                CNALF4,CNAAF4(20),CNLF4(20),CNNLF4(20),CNF4AT(20),
     2                XCPL4,XCPNL4,CMFL4(20),CMFNL4(20),CMF4AT(20),
     3                CAOF4,CANLF4(20),ALPTF4(20),CNFIT4(20),AI4,ALO4,
     4                CLI4,CLM4(20)
C
      COMMON /SFIN1/ CNF1(20),CMF1(20),CAF1(20),CYF1(20),CLNF1(20),
     1               CLLF1(20),CNAF1(20),CMAF1(20),CYBF1(20),
     2               CNBF1(20),CLBF1(20)
      COMMON /SFIN2/ CNF2(20),CMF2(20),CAF2(20),CYF2(20),CLNF2(20),
     1               CLLF2(20),CNAF2(20),CMAF2(20),CYBF2(20),
     2               CNBF2(20),CLBF2(20)
      COMMON /SFIN3/ CNF3(20),CMF3(20),CAF3(20),CYF3(20),CLNF3(20),
     1               CLLF3(20),CNAF3(20),CMAF3(20),CYBF3(20),
     2               CNBF3(20),CLBF3(20)
      COMMON /SFIN4/ CNF4(20),CMF4(20),CAF4(20),CYF4(20),CLNF4(20),
     1               CLLF4(20),CNAF4(20),CMAF4(20),CYBF4(20),
     2                CNBF4(20),CLBF4(20)
      COMMON /GEOFS1/ DM11(170),FNAR1,DM12(8),SWV251,DM13(8)
      COMMON /GEOFS2/ DM21(170),FNAR2,DM22(8),SWV252,DM23(8)
      COMMON /GEOFS3/ DM31(170),FNAR3,DM32(8),SWV253,DM33(8)
      COMMON /GEOFS4/ DM41(170),FNAR4,DM42(8),SWV254,DM43(8)
C      
      COMMON /PARTF/ PARTS(19)
      LOGICAL PARTS
      COMMON /LOGIC/ LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,
     1               LDERRD,LPART,LNAME,LPLOT,
     2               LFLT,LREFQ,LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,
     3               LDEFL,LTRIM,LDIMIN,LDIMFT,LDIMCM,LDIMM,LELLB,
     4               LINLET,LEXPR,LICRMT,LSPIN,LARBOD
      LOGICAL        LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,
     1               LDERRD,LPART,LNAME,LPLOT,
     2               LFLT,LREFQ,LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,
     3               LDEFL,LTRIM,LDIMIN,LDIMFT,LDIMCM,LDIMM,LELLB,
     4               LINLET,LEXPR,LICRMT,LSPIN,LARBOD
C      
      DIMENSION IROUT(2),X(20),R(20)
C      
      EQUIVALENCE (X(1),BDIN(3)),(R(1),BDIN(53))
C      
C***  DETERMINE BODY RADIUS AT FIN ROOT LEADING EDGE
C      
      NX = BDIN(1) + 0.5
      RBOD=0.
      XO=BDIN(2)
      IF(BDIN(1).GT.UNUSED) CALL LNTRP(X,R,NX,XLEF+XO,RBOD)
C      
C***  COMPUTE LINEAR FIN ALONE CENTER OF PRESSURE LOCATION
C      
      IF(SWAVLE .GE. 0.)
     1 CALL FALCP(MACH(IM),2.*FINAR,SWAVLE,FINTPR,XCPFLR)
      IF(SWAVLE .LT. 0.)
     1 CALL FWDXAC(MACH(IM),2.*FINAR,SWAVLE,FINTPR,XCPFLR)
      XCPFL = XLEF+XCPFLR*CROOT
C      
C***  NONLINEAR FIN ALONE CENTER OF PRESSURE LOCATION
C***   (ASSUMED AT GEOMETRIC CENTROID)
C      
      XCPFNL = XLEF+XCENF
C      
C***  COMPUTE LINEAR AND NONLINEAR MOMENT ARMS
C     
      DXL = (XCG-XO)-XCPFL
      DXNL = (XCG-XO)-XCPFNL
C      
C***  ANGLE OF ATTACK LOOP
C      
      NALP = NALPHA + 0.5
C      
      DO 1130 I=1,NALP
C      
C***  GET LINEAR AND NONLINEAR NORMAL FORCE CONTRIBUTIONS
C***  AND CORRECT THE SECTIONAL CMO FOR 3-D EFFECTS AS PER
C***  DATCOM EQ 4.1.4.1-A
C      
      GO TO (1000,1010,1020,1030), NFIN
C      
 1000 CNL = CNLF1(I)
      CNNL= CNNLF1(I)
      CMCO4T=CMCO41(IM)*(FNAR1*(COS(SWV251/RAD))**2/(FNAR1+2
     1       *COS(SWV251/RAD)))
      GO TO 1040
C      
 1010 CNL = CNLF2(I)
      CNNL= CNNLF2(I)
      CMCO4T=CMCO42(IM)*(FNAR2*(COS(SWV252/RAD))**2/(FNAR2+2
     1       *COS(SWV252/RAD)))
      GO TO 1040
C      
 1020 CNL = CNLF3(I)
      CNNL= CNNLF3(I)
      CMCO4T=CMCO43(IM)*(FNAR3*(COS(SWV253/RAD))**2/(FNAR3+2
     1       *COS(SWV253/RAD)))
      GO TO 1040
C      
 1030 CNL = CNLF4(I)
      CNNL= CNNLF4(I)
      CMCO4T=CMCO44(IM)*(FNAR4*(COS(SWV254/RAD))**2/(FNAR4+2
     1       *COS(SWV254/RAD)))
C      
 1040 CONTINUE
C      
C***  COMPUTE FIN ALONE PITCHING MOMENT COEFFICIENT
C      
      CMFL = CNL*DXL/LREF
      CMFNL= CNNL*DXNL/LREF
      CMF  = CMFL + CMFNL + CMCO4T*2.*FINSP*FINCBR/(SREF*LREF)
C      
C***     STORE MOMENT COEFFICIENTS IN WORK ARRAYS
C      
         GO TO (1050,1070,1090,1110),NFIN
C           HERE IF FIN SET 1
 1050    IF(I .NE. 1) GO TO 1060
         XCPL1 = XCPFL
         XCPNL1 = XCPFNL
 1060    CMFL1(I) = CMFL
         CMFNL1(I)= CMFNL
         CMF1AT(I)= CMF
         GO TO 1130
C           HERE IF FIN SET 2
 1070    IF(I .NE. 1) GO TO 1080
         XCPL2 = XCPFL
         XCPNL2= XCPFNL
 1080    CMFL2(I) = CMFL
         CMFNL2(I)= CMFNL
         CMF2AT(I)= CMF
         GO TO 1130
C           HERE IF FIN SET 3
 1090    IF(I .NE. 1) GO TO 1100
         XCPL3 = XCPFL
         XCPNL3= XCPFNL
 1100    CMFL3(I) = CMFL
         CMFNL3(I)= CMFNL
         CMF3AT(I)= CMF
         GO TO 1130
C           HERE IF FIN SET 4
 1110    IF(I .NE. 1) GO TO 1120
         XCPL4 = XCPFL
         XCPNL4= XCPFNL
 1120    CMFL4(I) = CMFL
         CMFNL4(I)= CMFNL
         CMF4AT(I)= CMF
C      
 1130 CONTINUE
C      
C***  INTERPOLATE ALPHA TOTAL DERIVED CURVE AT BODY
C***  ANGLE OF ATTACK FOR STORAGE AND PRINTOUT
C      
      DO 1180 I=1,NALP
         GO TO (1140,1150,1160,1170),NFIN
 1140    CALL LNTRP(ALPTOT,CMF1AT,NALP,BALPHA(I),CMF1(I))
         GO TO 1180
 1150    CALL LNTRP(ALPTOT,CMF2AT,NALP,BALPHA(I),CMF2(I))
         GO TO 1180
 1160    CALL LNTRP(ALPTOT,CMF3AT,NALP,BALPHA(I),CMF3(I))
         GO TO 1180
 1170    CALL LNTRP(ALPTOT,CMF4AT,NALP,BALPHA(I),CMF4(I))
C      
 1180 CONTINUE
C      
      IF(.NOT. PARTS(NFIN+6))GO TO 1190
C      
C***  FIN SET PARTIAL OUTPUT RESULTS
C      
      IF(NFIN .EQ. 1)CALL FPART9(IM,1,NALP,BALPHA,XCPL1,XCPNL1,
     1   XCG,LREF,CMFL1,CMFNL1,CMF1,XO,
     2   CNALF1,CNLF1,CNNLF1,CNF1AT)
      IF(NFIN .EQ. 2)CALL FPART9(IM,2,NALP,BALPHA,XCPL2,XCPNL2,
     1   XCG,LREF,CMFL2,CMFNL2,CMF2,XO,
     2   CNALF2,CNLF2,CNNLF2,CNF2AT)
      IF(NFIN .EQ. 3)CALL FPART9(IM,3,NALP,BALPHA,XCPL3,XCPNL3,
     1   XCG,LREF,CMFL3,CMFNL3,CMF3,XO,
     2   CNALF3,CNLF3,CNNLF3,CNF3AT)
      IF(NFIN .EQ. 4)CALL FPART9(IM,4,NALP,BALPHA,XCPL4,XCPNL4,
     1   XCG,LREF,CMFL4,CMFNL4,CMF4,XO,
     2   CNALF4,CNLF4,CNNLF4,CNF4AT)
C      
 1190 CONTINUE
C      
      RETURN
      END
