      SUBROUTINE FDAMP(IM)
C
C  THIS ROUTINES CALCULATES THE FIN CONTRIBUTION TO THE
C  ALPHA-DOT DYNAMIC DERIVATIVES USING SLENDER BODY THEORY
C
C  WRITTEN BY WILLIAM BLAKE
C  REV 5/97 UPDATE - NEW ROUTINE
C
      COMMON /CONST/ PI,RAD,UNUSED,KAND
      COMMON /FLC/    NALPHA,ALPHA(20),BETA,PHI,NMACH,MACH(20),
     1                ALT(20),REN(20),VINF(20),TINF(20),PINF(20)
      COMMON /REFQN/  SREF,LREF,LATREF,ROUGH,XCG,ZCG,SCALE,BLAYER,RHR
C
      COMMON /FSET1/  FDATA1(399)
      COMMON /FSET2/  FDATA2(399)
      COMMON /FSET3/  FDATA3(399)
      COMMON /FSET4/  FDATA4(399)
      COMMON /GEOFS1/  GFIN1(188)
      COMMON /GEOFS2/  GFIN2(188)
      COMMON /GEOFS3/  GFIN3(188)
      COMMON /GEOFS4/  GFIN4(188)
C
      COMMON /DBODY/ DUM0(360),BCNAD(20),BCMAD(20)
      COMMON /DB1/   DUM1(360),D1CNAD(20),D1CMAD(20)
      COMMON /DB12/  DUM2(360),D2CNAD(20),D2CMAD(20)
      COMMON /DB123/ DUM3(360),D3CNAD(20),D3CMAD(20)
      COMMON /DB1234/DUM4(360),D4CNAD(20),D4CMAD(20)
C
      COMMON /LOGIC/ LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,LDERRD,LPART,
     1               LDUM(4),LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,LDUM2(6),
     2               LELLB,LDUM3(3),LSPIN,LARBOD
      DIMENSION PHI1(8),PHI2(8),PHI3(8),PHI4(8),TCN(4),TCM(4)
      DIMENSION GAM1(8),GAM2(8),GAM3(8),GAM4(8)
      EQUIVALENCE (PHI1(1),FDATA1(382)),(PHI2(1),FDATA2(382))
      EQUIVALENCE (PHI3(1),FDATA3(382)),(PHI4(1),FDATA4(382))
      EQUIVALENCE (GAM1(1),FDATA1(374)),(GAM2(1),FDATA2(374))
      EQUIVALENCE (GAM3(1),FDATA3(374)),(GAM4(1),FDATA4(374))
C
      LOGICAL     LFIN1,LFIN2,LFIN3,LFIN4
      REAL MACH,NALPHA,LREF
      REAL NPAN1,NPAN2,NPAN3,NPAN4
C
      NALP=NALPHA+0.5
C
      IF(.NOT. LFIN1) GO TO 2000
C
C   BODY+1 FIN SET
C
      SPAN=2.*GFIN1(173)
      AREA=2.*GFIN1(174)
      PCENT=GFIN1(187)
      XLE=FDATA1(102)
      XCENT=PCENT+XLE
      AR=SPAN**2/AREA
      NPAN1=FDATA1(112)
      NP=NPAN1+0.5
C
C  ANGLE OF ATTACK LOOP
C
      DO 1100 I=1,NALP
      TCN(1)=0.
      TCM(1)=0.
C
C  COMPUTE AND SUM INDIVIDUAL PANEL VALUES
C
        DO 1110 II=1,NP
          CCORR=( SIN( (PHI1(II)+GAM1(II)) /RAD) )**2
          F1CNAD=2.*PI/3.*CCORR*(SPAN/LREF)*(AREA/SREF)
          F1CMAD=F1CNAD*(XCG-XCENT)/LREF
     1    -1.*PI/(9.*AR)*CCORR*(SPAN/LREF)**2*(AREA/SREF)
          TCN(1)=TCN(1)+0.5*F1CNAD
          TCM(1)=TCM(1)+0.5*F1CMAD
 1110   CONTINUE
C
C  ADD TO BODY ALONE TO GET BODY +1 FIN SET TOTAL
C
        D1CNAD(I)=BCNAD(I)+TCN(1)
        D1CMAD(I)=BCMAD(I)+TCM(1)
 1100 CONTINUE
C
      IF(.NOT. LFIN2) GO TO 2000
C
C   BODY+2 FIN SETS
C
      SPAN=2.*GFIN2(173)
      AREA=2.*GFIN2(174)
      PCENT=GFIN2(187)
      XLE=FDATA2(102)
      XCENT=PCENT+XLE
      AR=SPAN**2/AREA
      NPAN1=FDATA2(112)
      NP=NPAN1+0.5
C
C  ANGLE OF ATTACK LOOP
C
      DO 1200 I=1,NALP
      TCN(2)=0.
      TCM(2)=0.
C
C  COMPUTE AND SUM INDIVIDUAL PANEL VALUES
C
        DO 1210 II=1,NP
          CCORR=( SIN( (PHI2(II)+GAM2(II)) /RAD) )**2
          F2CNAD=2.*PI/3.*CCORR*(SPAN/LREF)*(AREA/SREF)
          F2CMAD=F2CNAD*(XCG-XCENT)/LREF
     1    -1.*PI/(9.*AR)*CCORR*(SPAN/LREF)**2*(AREA/SREF)
          TCN(2)=TCN(2)+0.5*F2CNAD
          TCM(2)=TCM(2)+0.5*F2CMAD
 1210   CONTINUE
C
C  ADD TO BODY ALONE TO GET BODY+2 FIN SETS TOTAL
C
        D2CNAD(I)=D1CNAD(I)+TCN(2)
        D2CMAD(I)=D1CMAD(I)+TCM(2)
 1200 CONTINUE
C
      IF(.NOT. LFIN3) GO TO 2000
C
C   BODY+3 FIN SETS
C
      SPAN=2.*GFIN3(173)
      AREA=2.*GFIN3(174)
      PCENT=GFIN3(187)
      XLE=FDATA3(102)
      XCENT=PCENT+XLE
      AR=SPAN**2/AREA
      NPAN1=FDATA3(112)
      NP=NPAN1+0.5
C
C  ANGLE OF ATTACK LOOP
C
      DO 1300 I=1,NALP
      TCN(3)=0.
      TCM(3)=0.
C
C  COMPUTE AND SUM INDIVIDUAL PANEL VALUES
C
        DO 1310 II=1,NP
          CCORR=( SIN( (PHI3(II)+GAM3(II)) /RAD) )**2
          F3CNAD=2.*PI/3.*CCORR*(SPAN/LREF)*(AREA/SREF)
          F3CMAD=F3CNAD*(XCG-XCENT)/LREF
     1    -1.*PI/(9.*AR)*CCORR*(SPAN/LREF)**2*(AREA/SREF)
          TCN(3)=TCN(3)+0.5*F3CNAD
          TCM(3)=TCM(3)+0.5*F3CMAD
 1310   CONTINUE
C
C  ADD TO BODY ALONE TO GET BODY +3 FIN SETS TOTAL
C
        D3CNAD(I)=D2CNAD(I)+TCN(3)
        D3CMAD(I)=D2CMAD(I)+TCM(3)
 1300 CONTINUE
C
      IF(.NOT. LFIN4) GO TO 2000
C
C   BODY+4 FIN SETS
C
      SPAN=2.*GFIN4(173)
      AREA=2.*GFIN4(174)
      PCENT=GFIN4(187)
      XLE=FDATA4(102)
      XCENT=PCENT+XLE
      AR=SPAN**2/AREA
      NPAN1=FDATA4(112)
      NP=NPAN1+0.5
C
C  ANGLE OF ATTACK LOOP
C
      DO 1400 I=1,NALP
      TCN(4)=0.
      TCM(4)=0.
C
C  COMPUTE AND SUM INDIVIDUAL PANEL VALUES
C
        DO 1410 II=1,NP
          CCORR=( SIN( (PHI4(II)+GAM4(II)) /RAD) )**2
          F4CNAD=2.*PI/3.*CCORR*(SPAN/LREF)*(AREA/SREF)
          F4CMAD=F4CNAD*(XCG-XCENT)/LREF
     1    -1.*PI/(9.*AR)*CCORR*(SPAN/LREF)**2*(AREA/SREF)
          TCN(4)=TCN(4)+0.5*F4CNAD
          TCM(4)=TCM(4)+0.5*F4CMAD
 1410   CONTINUE
C
C  ADD TO BODY ALONE TO GET BODY +4 FIN SETS TOTAL
C
        D4CNAD(I)=D3CNAD(I)+TCN(4)
        D4CMAD(I)=D3CMAD(I)+TCM(4)
 1400 CONTINUE
C
 2000 CONTINUE
      RETURN
      END
