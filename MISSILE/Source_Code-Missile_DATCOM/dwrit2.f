      SUBROUTINE DWRIT2(IM)
C      
C  REV 1/96 UPDATE - NEW SUBROUTINE
C
C***    SUBROUTINE TO PRINT DYNAMIC DERIVATIVES
C
C  WRITTEN BY W. BLAKE, WL/FIGC
C      
C***    INPUT
C      
C     IM=MACH NUMBER INDEX
C
      COMMON /CASEID/ CC(177),NOLAT,IR,IPAGE
      COMMON /DBODY/ BCNQ(20),BCMQ(20),BCAQ(20),BCYQ(20),
     1  BCLNQ(20),BCLLQ(20),BCNR(20),BCMR(20),BCAR(20),
     2  BCYR(20),BCLNR(20),BCLLR(20),BCNP(20),BCMP(20),
     3  BCAP(20),BCYP(20),BCLNP(20),BCLLP(20),
     4  BCNAD(20),BCMAD(20),CLLP,CYP,CNP1,CNP3,CNP5,CNPY5
C
      COMMON /DB1/ D1CNQ(20),D1CMQ(20),D1CAQ(20),D1CYQ(20),
     1  D1CLNQ(20),D1CLLQ(20),D1CNR(20),D1CMR(20),D1CAR(20),
     2  D1CYR(20),D1CLNR(20),D1CLLR(20),D1CNP(20),D1CMP(20),
     3  D1CAP(20),D1CYP(20),D1CLNP(20),D1CLLP(20),
     4  D1CNAD(20),D1CMAD(20)
C
      COMMON /DB12/ D2CNQ(20),D2CMQ(20),D2CAQ(20),D2CYQ(20),
     1  D2CLNQ(20),D2CLLQ(20),D2CNR(20),D2CMR(20),D2CAR(20),
     2  D2CYR(20),D2CLNR(20),D2CLLR(20),D2CNP(20),D2CMP(20),
     3  D2CAP(20),D2CYP(20),D2CLNP(20),D2CLLP(20),
     4  D2CNAD(20),D2CMAD(20)
C
      COMMON /DB123/ D3CNQ(20),D3CMQ(20),D3CAQ(20),D3CYQ(20),
     1  D3CLNQ(20),D3CLLQ(20),D3CNR(20),D3CMR(20),D3CAR(20),
     2  D3CYR(20),D3CLNR(20),D3CLLR(20),D3CNP(20),D3CMP(20),
     3  D3CAP(20),D3CYP(20),D3CLNP(20),D3CLLP(20),
     4  D3CNAD(20),D3CMAD(20)
C
      COMMON /DB1234/ D4CNQ(20),D4CMQ(20),D4CAQ(20),D4CYQ(20),
     1  D4CLNQ(20),D4CLLQ(20),D4CNR(20),D4CMR(20),D4CAR(20),
     2  D4CYR(20),D4CLNR(20),D4CLLR(20),D4CNP(20),D4CMP(20),
     3  D4CAP(20),D4CYP(20),D4CLNP(20),D4CLLP(20),
     4  D4CNAD(20),D4CMAD(20)
C
      COMMON /LOGIC/ LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,LDERRD,LPART,
     1               LDUM(4),LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,LDUM2(6),
     2               LELLB,LDUM3(3),LSPIN,LARBOD
      COMMON /FLC/ NALP,ALPHA(20),FLDUM(123)
      LOGICAL LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,LDERRD,LPART,LDUM3,
     1        LDUM,LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,LDUM2,LSPIN,LELLB
      LOGICAL NDUM,NMF,NAF,NOLAT
      REAL NALP
      NALPHA=NALP+.5
C      
C***    IF OUTPUT IS TO BE IN DEGREES CONVERT FROM RADIANS
C      
      IF(.NOT.LDERRD) CALL DDCVRT
C      
C***   PRINT BODY ALONE DYNAMICS
C      
 1010 IF((LAXIS.OR.LELLB) .AND. (LPART.OR.LBUILD))GO TO 1020
      IF(.NOT. ((LAXIS.OR.LELLB) .AND. .NOT. LFIN1))GO TO 1160
 1020 CONTINUE
C
C  LONGITUDINAL
C
      CALL HEADR9
      WRITE(6,1300)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1375)
      DO 1030 I=1,NALPHA
        WRITE(6,1382) ALPHA(I),BCNQ(I),BCMQ(I),BCAQ(I),BCNAD(I),
     1   BCMAD(I)
 1030 CONTINUE
      WRITE(6,1385)
      IF(NOLAT) GO TO 1035
C
C  LATERAL-DIRECTIONAL
C
      CALL HEADR9
      WRITE(6,1300)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1377)
      DO 1032 I=1,NALPHA
        WRITE(6,1384) ALPHA(I),BCYR(I),BCLNR(I),BCLLR(I),BCYP(I),
     1      BCLNP(I),BCLLP(I)
 1032 CONTINUE
      WRITE(6,1387)
 1035 CONTINUE
C
C  MAGNUS DERIVATIVE CALCULATIONS FOR BODY ALONE
C
      IF(.NOT. LSPIN) GO TO 1160
      IF(.NOT. LDERRD)WRITE(6,1410)
      IF(LDERRD)WRITE(6,1420)
      WRITE(6,1430)
      WRITE(6,1440) CLLP,CYP,CNP1,CNP3,CNP5,CNPY5
      WRITE(6,1450)
      WRITE(6,1460)
C      
C       DETERMINE NUMBER OF FIN SETS DEFINED
C      
 1160 NFS=0
      IF(LFIN1)NFS=NFS+1
      IF(LFIN2)NFS=NFS+1
      IF(LFIN3)NFS=NFS+1
      IF(LFIN4)NFS=NFS+1
      IF(NFS.EQ.0 .OR. (.NOT.(LFIN1 .AND. (LAXIS.OR.LELLB))))GO TO 1250
      IF(LBUILD)GO TO 1170
      GO TO (1170,1190,1210,1230),NFS
C      
C***     PRINT BODY + 1 FINSET DYNAMICS
C      
 1170 CONTINUE
C
C  LONGITUDINAL
C
      CALL HEADR9
      WRITE(6,1310)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1375)
      DO 1180 I=1,NALPHA
         WRITE(6,1382) ALPHA(I),D1CNQ(I),D1CMQ(I),D1CAQ(I),
     1   D1CNAD(I),D1CMAD(I)
 1180 CONTINUE
      WRITE(6,1385)
      IF(NOLAT) GO TO 1185
C
C  LATERAL-DIRECTIONAL
C
      CALL HEADR9
      WRITE(6,1310)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1377)
      DO 1182 I=1,NALPHA
         WRITE(6,1384) ALPHA(I),D1CYR(I),D1CLNR(I),D1CLLR(I),
     1   D1CYP(I),D1CLNP(I),D1CLLP(I)
 1182 CONTINUE
      WRITE(6,1387)
 1185 CONTINUE
      IF(LBUILD)GO TO 1190
      GO TO 1250
C      
C***    PRINT BODY + 2 FINSET DYNAMICS
C      
 1190 IF(NFS .LE. 1)GO TO 1250
C
C  LONGITUDINAL
C
      CALL HEADR9
      WRITE(6,1320)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1375)
      DO 1200 I=1,NALPHA
         WRITE(6,1382) ALPHA(I),D2CNQ(I),D2CMQ(I),D2CAQ(I),
     1   D2CNAD(I),D2CMAD(I)
 1200 CONTINUE
      WRITE(6,1385)
      IF(NOLAT) GO TO 1205
C
C  LATERAL-DIRECTIONAL
C
      CALL HEADR9
      WRITE(6,1320)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1377)
      DO 1202 I=1,NALPHA
         WRITE(6,1384) ALPHA(I),D2CYR(I),D2CLNR(I),D2CLLR(I),
     1   D2CYP(I),D2CLNP(I),D2CLLP(I)
 1202 CONTINUE
      WRITE(6,1387)
 1205 CONTINUE
      IF(LBUILD)GO TO 1210
      GO TO 1250
C      
C***    PRINT BODY + 3 FINSET DYNAMICS
C      
 1210 IF(NFS .LE. 2)GO TO 1250
C
C  LONGITUDINAL
C
      CALL HEADR9
      WRITE(6,1330)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1375)
      DO 1220 I=1,NALPHA
         WRITE(6,1382) ALPHA(I),D3CNQ(I),D3CMQ(I),D3CAQ(I),
     1   D3CNAD(I),D3CMAD(I)
 1220 CONTINUE
      WRITE(6,1385)
      IF(NOLAT) GO TO 1225
C
C  LATERAL-DIRECTIONAL
C
      CALL HEADR9
      WRITE(6,1300)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1377)
      DO 1222 I=1,NALPHA
         WRITE(6,1384) ALPHA(I),D3CYR(I),D3CLNR(I),D3CLLR(I),
     1   D3CYP(I),D3CLNP(I),D3CLLP(I)
 1222 CONTINUE
      WRITE(6,1387)
 1225 CONTINUE
      IF(LBUILD)GO TO 1230
      GO TO 1250
C      
C***    PRINT BODY + 4 FINSET DYNAMICS
C      
 1230 IF(NFS.LE. 3)GO TO 1250
C
C  LONGITUDINAL
C
      CALL HEADR9
      WRITE(6,1340)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1375)
      DO 1240 I=1,NALPHA
         WRITE(6,1382) ALPHA(I),D4CNQ(I),D4CMQ(I),D4CAQ(I),
     1   D4CNAD(I),D4CMAD(I)
 1240 CONTINUE
      WRITE(6,1385)
      IF(NOLAT) GO TO 1245
C
C  LATERAL-DIRECTIONAL
C
      CALL HEADR9
      WRITE(6,1340)
      CALL PRFLC9(IM,NDUM,NMF,NAF)
      IF(.NOT. LDERRD)WRITE(6,1350)
      IF(LDERRD)WRITE(6,1360)
      WRITE(6,1377)
      DO 1242 I=1,NALPHA
         WRITE(6,1384) ALPHA(I),D4CYR(I),D4CLNR(I),D4CLLR(I),
     1   D4CYP(I),D4CLNP(I),D4CLLP(I)
 1242 CONTINUE
      WRITE(6,1387)
 1245 CONTINUE
C      
 1250 CONTINUE
C      
 1300 FORMAT(4X,23X,'BODY ALONE DYNAMIC DERIVATIVES',/)
 1310 FORMAT(4X,20X,'BODY + 1 FIN SET DYNAMIC DERIVATIVES',/)
 1320 FORMAT(4X,20X,'BODY + 2 FIN SETS DYNAMIC DERIVATIVES',/)
 1330 FORMAT(4X,20X,'BODY + 3 FIN SETS DYNAMIC DERIVATIVES',/)
 1340 FORMAT(4X,20X,'BODY + 4 FIN SETS DYNAMIC DERIVATIVES',/)
 1350 FORMAT(4X,16X,'------------ DYNAMIC DERIVATIVES (PER',
     1 ' DEGREE) -----------')
 1360 FORMAT(4X,16X,'------------ DYNAMIC DERIVATIVES (PER',
     1 ' RADIAN) -----------')
 1375 FORMAT(4X,5X,'ALPHA',7X,'CNQ',8X,'CMQ',8X,'CAQ',7X,
     1  'CNAD',7X,'CMAD')
 1377 FORMAT(4X,5X,'ALPHA',7X,'CYR',7X,'CLNR',7X,'CLLR',8X,
     1  'CYP',7X,'CLNP',7X,'CLLP')
 1382 FORMAT(4X,F10.2,5(F11.3))
 1384 FORMAT(4X,F10.2,6(F11.3))
 1385 FORMAT(/,4X,'PITCH RATE DERIVATIVES NON-DIMENSIONALIZED',
     1  ' BY Q*LREF/2*V')
 1387 FORMAT(/,4X,'YAW AND ROLL RATE DERIVATIVES NON-DIMENSIONALIZED',
     2  ' BY R*LATREF/2*V')
C
 1410 FORMAT(/,4X,'---------------- MAGNUS DERIVATIVES',
     1 ' (PER DEGREE) ------------------')
 1420 FORMAT(/,4X,'---------------- MAGNUS DERIVATIVES',
     1 ' (PER RADIAN) ------------------')
 1430 FORMAT(/,7X,'CLLP',9X,'CYP',10X,'CNP1',9X,'CNP3',9X,'CNP5',9X,
     1 'CNPA-5')
 1440 FORMAT(/,1P,4X,E10.3,3X,E10.3,3X,E10.3,3X,E10.3,3X,E10.3,3X,
     1E10.3,3X,E10.3)
 1450 FORMAT(/,4X,'CNP/SIN(ALPHA)=CNP1+CNP3*(SIN(ALPHA))**2+CNP5*',
     1 '(SIN(ALPHA))**4',/)
 1460 FORMAT(4X,'CAUTION- DO NOT USE THIS POLYNOMIAL PAST THE FIRST',
     1 ' POSITIVE EXTREME.',/,4X,'CNP IS EXPECTED TO STAY POSITIVE',
     2 ' AT HIGHER ANGLES OF ATTACK.')
C
      RETURN
      END
