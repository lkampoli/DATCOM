      SUBROUTINE GEOFIN
C
C***  SUBROUTINE TO COMPUTE FIN GEOMETRIC DATA
C
      COMMON /FSET1/  FDATA1(399)
      COMMON /FSET2/  FDATA2(399)
      COMMON /FSET3/  FDATA3(399)
      COMMON /FSET4/  FDATA4(399)
C
      COMMON /GEOFS1/ GFIN1(188)
      COMMON /GEOFS2/ GFIN2(188)
      COMMON /GEOFS3/ GFIN3(188)
      COMMON /GEOFS4/ GFIN4(188)
C
      COMMON /INCID/  DELTAS(32),XHINGE(4),SKEW(4)
C
      DIMENSION SSPAN(10),LMAXU(10),LFLATU(10),LMAXL(10),
     1          LFLATL(10),CHORD(10),THICKU(10),THICKL(10),
     2          SWEEP(10),STA(10),XLE(10),
     3          XCORD(50),MEAN(50),THICK(50),YUPPER(50),
     4          YLOWER(50),LER(10)
C
      REAL LER,LMAXU,LMAXL,LFLATU,LFLATL,NPANEL,MEAN
C
      EQUIVALENCE (FDATA1(1),SECTYP),(FDATA1(2),SSPAN(1)),
     1            (FDATA1(12),LMAXU(1)),(FDATA1(22),LFLATU(1)),
     2            (FDATA1(32),LMAXL(1)),(FDATA1(42),LFLATL(1)),
     3            (FDATA1(52),CHORD(1)),(FDATA1(62),THICKU(1)),
     4            (FDATA1(72),THICKL(1)),(FDATA1(82),SWEEP(1)),
     5            (FDATA1(92),STA(1)),(FDATA1(102),XLE(1)),
     6            (FDATA1(112),NPANEL),(FDATA1(113),XCORD(1)),
     7            (FDATA1(163),MEAN(1)),(FDATA1(213),THICK(1)),
     8            (FDATA1(263),YUPPER(1)),(FDATA1(313),YLOWER(1)),
     9            (FDATA1(363),FINPHI),(FDATA1(364),LER(1))
C
      DIMENSION SPLANF(10),CBAR(10),SWEPLE(10),SWEP25(10),
     1          SWEP50(10),SWEP75(10),SWEPTE(10),
     2          XMGCLE(10),XMGC25(10),
     3          XMGC50(10),XMGC75(10),XMGCTE(10),YMEANC(10),
     4          ASPCT(10),TAPER(10),TOVERC(10),XCENT(10)
C
      EQUIVALENCE (GFIN1(1),SPLANF(1)),(GFIN1(11),CBAR(1)),
     1            (GFIN1(21),SWEPLE(1)),(GFIN1(31),SWEP25(1)),
     2            (GFIN1(41),SWEP50(1)),(GFIN1(51),SWEP75(1)),
     3            (GFIN1(61),SWEPTE(1)),(GFIN1(71),XMGCLE(1)),
     4            (GFIN1(81),XMGC25(1)),(GFIN1(91),XMGC50(1)),
     5            (GFIN1(101),XMGC75(1)),(GFIN1(111),XMGCTE(1)),
     6            (GFIN1(121),YMEANC(1)),(GFIN1(131),ASPCT(1)),
     7            (GFIN1(141),TAPER(1)),(GFIN1(151),TOVERC(1)),
     8            (GFIN1(161),XCENT(1)),(GFIN1(171),FINAR),
     9            (GFIN1(172),FINTPR),(GFIN1(173),FINSPN),
     A            (GFIN1(174),FINSP),(GFIN1(175),FINWET),
     B            (GFIN1(176),TCEFF),(GFIN1(177),FINXGC),
     C            (GFIN1(178),FINYGC),(GFIN1(179),SWAVLE),
     D            (GFIN1(180),SWAV25),(GFIN1(181),SWAV50),
     E            (GFIN1(182),SWAV75),(GFIN1(183),SWAVTE),
     F            (GFIN1(184),FINCBR),(GFIN1(185),DELTAY),
     G            (GFIN1(186),DELTAD)
C
      COMMON /CONST/ PI,RAD,UNUSED,DEG
C
      COMMON /REFQN/  SREF,LREF,LATREF,ROUGH,XCG,ZCG,SCALE,BLAYER,RHR
C
      REAL LREF,LATREF
C
      COMMON /LOGIC/ LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,
     1               LDERRD,LPART,LNAME,LPLOT,
     2               LFLT,LREFQ,LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,
     3               LDEFL,LTRIM,LDIMIN,LDIMFT,LDIMCM,LDIMM,LELLB,
     4               LINLET,LEXPR,LICRMT,LSPIN,LARBOD
      LOGICAL        LDMPCS,LDAMP,LBUILD,LNACA,LDERDG,
     1               LDERRD,LPART,LNAME,LPLOT,
     2               LFLT,LREFQ,LAXIS,LFIN1,LFIN2,LFIN3,LFIN4,
     3               LDEFL,LTRIM,LDIMIN,LDIMFT,LDIMCM,LDIMM,LELLB,
     4               LINLET,LEXPR,LICRMT,LSPIN,LARBOD
C
C***  SCALE INPUT GEOMETRY IF REQUIRED
C
      IF(SCALE .EQ. 0. .OR. SCALE .EQ. UNUSED)SCALE=1.
C
      IF(SCALE .EQ. 1.)GO TO 1010
C
      DO 1000 I=2,111
         IF(I .GE. 12 .AND. I .LE.  51)GO TO 1000
         IF(I .GE. 62 .AND. I .LE. 101)GO TO 1000
         IF(FDATA1(I) .NE. UNUSED)FDATA1(I)=SCALE*FDATA1(I)
         IF(FDATA2(I) .NE. UNUSED)FDATA2(I)=SCALE*FDATA2(I)
         IF(FDATA3(I) .NE. UNUSED)FDATA3(I)=SCALE*FDATA3(I)
         IF(FDATA4(I) .NE. UNUSED)FDATA4(I)=SCALE*FDATA4(I)
 1000 CONTINUE
C
      DO 1005 I=364,373
         IF(FDATA1(I) .NE. UNUSED)FDATA1(I)=SCALE*FDATA1(I)
         IF(FDATA2(I) .NE. UNUSED)FDATA2(I)=SCALE*FDATA2(I)
         IF(FDATA3(I) .NE. UNUSED)FDATA3(I)=SCALE*FDATA3(I)
         IF(FDATA4(I) .NE. UNUSED)FDATA4(I)=SCALE*FDATA4(I)
 1005 CONTINUE
C
      IF(XHINGE(1) .NE. UNUSED)XHINGE(1)=XHINGE(1)*SCALE
      IF(XHINGE(2) .NE. UNUSED)XHINGE(2)=XHINGE(2)*SCALE
      IF(XHINGE(3) .NE. UNUSED)XHINGE(3)=XHINGE(3)*SCALE
      IF(XHINGE(4) .NE. UNUSED)XHINGE(4)=XHINGE(4)*SCALE
C
 1010 CONTINUE
C
C***  COMPUTE GEOMETRIC DATA FOR ALL FIN SETS PRESENT
C
      CALL FGEOM
C
C***  SET REFERENCE QUANTITIES IF ABSENT
C
      IF(SREF .NE. 0. .AND. SREF .NE. UNUSED)GO TO 1020
C
         SREF=GFIN1(174)
         IF(SREF .LT. GFIN2(174))SREF=GFIN2(174)
         IF(SREF .LT. GFIN3(174))SREF=GFIN3(174)
         IF(SREF .LT. GFIN4(174))SREF=GFIN4(174)
C
 1020 IF(LREF .NE. 0. .AND. LREF .NE. UNUSED)GO TO 1030
C
         LREF=GFIN1(184)
         IF(LREF .LT. GFIN2(184))LREF=GFIN2(184)
         IF(LREF .LT. GFIN3(184))LREF=GFIN3(184)
         IF(LREF .LT. GFIN4(184))LREF=GFIN4(184)
C
 1030 CONTINUE
C
      IF(LATREF .EQ. 0. .OR. LATREF .EQ. UNUSED)LATREF=LREF
C
C***  OUTPUT GEOMETRIC RESULTS
C
      CALL PRIFIN
C
      RETURN
      END
